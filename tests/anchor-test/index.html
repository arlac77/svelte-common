<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf8" />
    <title>Anchor test</title>
    <style>
      button {
      }

      #menu {
        color: green;
        border-width: 1px;
        border-color: blue;
        padding: 0;
        margin: 0;
      }
      li {
        display: block;
      }

      svg {
        position: sticky;
      }
    </style>
  </head>
  <body>
    <button id="a">Anchor</button>
    <ul id="menu">
      <li>AAA</li>
      <li>BBB</li>
      <li>CCC</li>
      <li>DDD</li>
      <li>EEE</li>
      <li>FFF</li>
    </ul>

    <svg
      x="0"
      y="0"
      width="400"
      height="400"
      viewBox="0 0 400 400"
      style="z-index: -1"
    >
      <rect
        id="anchor"
        fill="#ddd"
        stroke="blue"
        stroke-width="1"
        visibility="visible"
      />
      <rect
        draggable="true"
        id="content"
        fill="#ddd"
        stroke="green"
        stroke-width="1"
        visibility="visible"
      />
      <path
        id="path"
        stroke="red"
        fill="#eee7"
        stroke-width="1"
        visibility="visible"
      />
    </svg>
  </body>
  <script>
    const anchor = document.getElementById("anchor");
    const content = document.getElementById("content");
    const path = document.getElementById("path");

    function calc() {
      const anchorBB = anchor.getBBox();
      const contentBB = content.getBBox();

      path.setAttribute(
        "d",
        `M ${anchorBB.x} ${anchorBB.y}
       Q ${contentBB.x} ${anchorBB.y}
        ${contentBB.x} ${contentBB.y}
       v ${contentBB.height}
       Q ${contentBB.x} ${anchorBB.y + anchorBB.height}
        ${anchorBB.x} ${anchorBB.y + anchorBB.height}
       h ${anchorBB.width}
       v ${-anchorBB.height}
       z
      `
      );
    }

    function makeDraggable(elem, attached) {
      const bb = elem.getBoundingClientRect();

      attached.setAttribute("x", bb.x);
      attached.setAttribute("y", bb.y);
      attached.setAttribute("width", bb.width);
      attached.setAttribute("height", bb.height);

      elem.setAttribute("draggable", "true");
      elem.ondrag = event => {
        elem.setAttribute("x", event.x);
        elem.setAttribute("y", event.y);

        attached.setAttribute("x", event.x);
        attached.setAttribute("y", event.y);
        calc();
      };
    }

    makeDraggable(document.getElementById("a"), anchor);
    makeDraggable(document.getElementById("menu"), content);

    calc();
  </script>
</html>
